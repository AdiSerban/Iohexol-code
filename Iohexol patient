#R code for Iohexol clearance 
#If calcul with height and weight with a fixed volume of omnipaque please complete Test=1, and the following data : Height in cm, weight in kg, omnipaque volume in mL, omnipaque type, concentrations in mg/L and times in minutes (4 concentrations are mandatory).
#If calcul with syringe weight before and after please complete Test=2, syringe weight in mg, BSA in squarred meters/kg, concentrations in mg/L and times in minutes (3 concentrations are mandatory).
#Type of omnipaque administration:
     #240mg/mL omnipaque or 518 mg/mL iohexol
     #180mg/mL omnipaque or 388 mg/mL iohexol
     #300mg/mL omnipaque or 647 mg/mL iohexol
     #350mg/mL omnipaque or 755 mg/mL iohexol


Height=
Weight=
Omnipaque_type=
Omnipaque_volume=
BSA=
syringe_weight_before=
syringe_weight_after=
Concentration1=
Concentration2=
Concentration3=
Concentration4=
Time1=
Time2=
Time3=
Time4=
Test=

#Test

if ( Test == 1 )
{
Conc<-c(Concentration1,Concentration2,Concentration3,Concentration4)
Time<-c(Time1,Time2,Time3,Time4)

LNconc<-log(Conc)
require(stats)
reg<-lm(LNconc~Time)
coeff=coefficients(reg)
origine<-exp(round(coeff[1],6))
pente<-round(coeff[2],6)
AUC=origine/(abs(pente))

X=Omnipaque_volume
#Defined omnipaque type
Y=Omnipaque_type

dose=X*518/240*Y
#clearance calculation in mL/min
CL=dose*1000/AUC
#BSA calculation by Gehan and Georges
BSA=0.0235*((Height)^0.42246)*((Weight)^0.51456)
#Brochner-Mortensen correction (only the second exponential is evaluated)
CLBM=0.990778*CL-0.001218*(CL^2)
#BSA normalized clearance mL/min/1.73m²
CLBMnormSC=CLBM*(1.73/BSA)


}

if ( Test == 2)
{
Conc<-c(Concentration1,Concentration2,Concentration3)
LNconc<-log(Conc)
Time<-c(Time1,Time2,Time3)
require(stats)
reg<-lm(LNconc~Time)
coeff=coefficients(reg)
origine<-exp(round(coeff[1],6))
pente<-round(coeff[2],6)
AUC=origine/(abs(pente))
if (Omnipaque_type == 240)
{
Density=1.280
}
if (Omnipaque_type == 180)
{
Density=1.209
}
if (Omnipaque_type == 300)
{
Density=1.349
}
if (Omnipaque_type == 350)
{
Density=1.406
}
dose=(syringe_weight_before-syringe_weight_after)*518*1000/Density
CL=dose/AUC
#BSA calculation by Gehan and Georges
#Brochner-Mortensen correction (only the second exponential is evaluated)
CLBM=0.990778*CL-0.001218*(CL^2)
#BSA normalized clearance mL/min/1.73m²
CLBMnormSC=CLBM*(1.73/BSA)
}
#Results


CLBM=round(CLBM,2)
CLBMnormSC=round(CLBMnormSC,2)
a=paste0("Iohexol clearance =   ", CLBM, "  mL/min")
b=paste0("Iohexol clearance normalised at BMI =   ",CLBMnormSC, "  mL/min/1.73m²")
a
b
